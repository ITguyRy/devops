<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>SaltStack Beginner Tutorial</title>
  <meta name="description" content="">

  <link rel="stylesheet" href="/css/main.css">
  <link rel="canonical" href="http://devopslibrary.com/lessons/saltstack-beginner-tutorial">
  <link rel="alternate" type="application/rss+xml" title="DevOps Library" href="http://devopslibrary.com/feed.xml">
</head>


  <body>

    <header class="site-header">

  <div class="wrapper">

    <a class="site-title" href="/">DevOps Library</a>

    <nav class="site-nav">
      <a href="#" class="menu-icon">
        <svg viewBox="0 0 18 15">
          <path fill="#424242" d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.031C17.335,0,18,0.665,18,1.484L18,1.484z"/>
          <path fill="#424242" d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484 h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z"/>
          <path fill="#424242" d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z"/>
        </svg>
      </a>

      <div class="trigger">
        
          
          <a class="page-link" href="/about/">About</a>
          
        
          
        
          
        
          
        
      </div>
    </nav>

  </div>

</header>


    <div class="page-content">
      <div class="wrapper">
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title" itemprop="name headline">SaltStack Beginner Tutorial</h1>
    <p class="post-meta"><time datetime="2015-08-13T13:00:00-04:00" itemprop="datePublished">Aug 13, 2015</time></p>
  </header>

  <div class="post-content" itemprop="articleBody">
    <div class="video"><figure><iframe width="640" height="480" src="//www.youtube.com/embed/TQjE2I8CrzQ" frameborder="0" allowfullscreen=""></iframe></figure></div>

<p>Today we’ll cover how to get up and running with Salt for configuration management. If you haven’t heard of Salt or the SaltStack, it’s very similar to Puppet, Ansible, or Chef, but is becoming extremely popular.</p>

<p>Vagrant File: <code class="highlighter-rouge">http://devopslibrary.com/episode2-salt.zip</code></p>

<p>Transcript:</p>

<p>Welcome to the DevOps Library episode 2, today we’ll quickly cover how to get up and running with Salt for configuration management.  Well let’s get started.  First make sure you have two blank Ubuntu 14.04 VMs ready to go—we’ve already have a Vagrant file ready, so if you’d like to start at the same place, just download the Vagrant zip for Episode 2 on the website.  If you’re not familiar with Vagrant, just watch our video on how to get started with it.</p>

<p>Now to begin.  We have two blank VMs, one is named salt which will be used as the salt master, and one named minion that is the VM that will be controlled by salt.  Please note that it’s extremely important that the hostname of the master IS actually salt, and the reason is that is the salt-minion service defaults to looking for that name.  You can change this but it’s much easier if you just name your salt server salt, trust me.</p>

<p>Now we need to make sure that we have the latest salt repository added to both the salt master and salt minion.  Run <code class="highlighter-rouge">add-apt-repository ppa:saltstack/salt</code> on both VMs, and hit enter to finish adding the key.  Next run an <code class="highlighter-rouge">apt-get update</code> on both VMs. This step is extremely important as this will ensure you have the latest version of salt, which runs MUCH better than the one that Ubuntu defaults to.</p>

<p>Now we’re ready to install salt.  On the minion, run <code class="highlighter-rouge">apt-get install salt-minion</code>.</p>

<p>Now switch to the salt-master and run <code class="highlighter-rouge">apt-get install salt-master</code> followed by <code class="highlighter-rouge">apt-get install salt-minion</code>.</p>

<p>While you don’t have to install the minion service on the server, we’re going to so that you can see how easy it is to control multiple servers through the salt command line.</p>

<p>While we’re waiting for those to install, let me just give you a quick overview of how the Saltstack works.  You’re probably already familiar with SSH, but if you think about trying to SSH into hundreds or thousands of servers, it’s impossible to scale.  That’s why Salt uses a service called ZeroMQ in the background for messaging.  If you’re not familiar with an AMPQ broker like ZeroMQ or RabbitMQ, it’s an extremely fast messaging bus that allows you to scale very, very easily.  Additionally, because Salt initiates everything from the client side, it is much easier to get going in highly locked down environments.</p>

<p>Now that the install is finished, the salt minion service on both VMs is going to provide the salt-master service with a public key.  We can’t control anything until those keys are accepted – and yes you can set salt up to automatically accept new keys if you’d like.</p>

<p>Run <code class="highlighter-rouge">salt-key -L</code> to see a list of keys, here you can see that the two keys are waiting for us to accept them.  To do so, run <code class="highlighter-rouge">salt-key –A</code>, and hit Yes.</p>

<p>Now if you run ‘salt-key –L’ you can see both keys listed under accepted.</p>

<p>Now we can finally see how to control as many servers as you want using salt.</p>

<p>First, from the master, run <code class="highlighter-rouge">salt '*'' test.ping</code></p>

<p>If you look at the command, the asterisk means run this on all servers reporting to salt, while the test.ping command is built-in to see if the minions are responding.  You should see both nodes now reporting true.</p>

<p>Next run <code class="highlighter-rouge">salt '*nion’ cmd.run 'ifconfig'</code>.  This is going to run ifconfig on the minion, because it’s the only server that matches the target string <code class="highlighter-rouge">*nion</code>.</p>

<p>You can use any type of wildcard that you want, now let’s run one last command
<code class="highlighter-rouge">salt * cmd.run 'df -h'</code></p>

<p>Notice we now can see the free space on both servers, as salt ran df –h on both servers.  I hope you can see how easy it was to get going.  Now keep in mind this is just a tiny fraction of what salt can do, we haven’t covered pillars, grains, states, or any of the other amazing features of salt, but I hope that’s enough to get you started.  Thanks for watching!</p>

  </div>

</article>

      </div>
    </div>

    <footer class="site-footer">

  <div class="wrapper">

    <h2 class="footer-heading">DevOps Library</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li>DevOps Library</li>
          <li><a href="mailto:admin@devopslibrary.com">admin@devopslibrary.com</a></li>
        </ul>
      </div>

      <div class="footer-col footer-col-2">
        <ul class="social-media-list">
          
          <li>
            <a href="https://github.com/kenerwin88"><span class="icon icon--github"><svg viewBox="0 0 16 16"><path fill="#828282" d="M7.999,0.431c-4.285,0-7.76,3.474-7.76,7.761 c0,3.428,2.223,6.337,5.307,7.363c0.388,0.071,0.53-0.168,0.53-0.374c0-0.184-0.007-0.672-0.01-1.32 c-2.159,0.469-2.614-1.04-2.614-1.04c-0.353-0.896-0.862-1.135-0.862-1.135c-0.705-0.481,0.053-0.472,0.053-0.472 c0.779,0.055,1.189,0.8,1.189,0.8c0.692,1.186,1.816,0.843,2.258,0.645c0.071-0.502,0.271-0.843,0.493-1.037 C4.86,11.425,3.049,10.76,3.049,7.786c0-0.847,0.302-1.54,0.799-2.082C3.768,5.507,3.501,4.718,3.924,3.65 c0,0,0.652-0.209,2.134,0.796C6.677,4.273,7.34,4.187,8,4.184c0.659,0.003,1.323,0.089,1.943,0.261 c1.482-1.004,2.132-0.796,2.132-0.796c0.423,1.068,0.157,1.857,0.077,2.054c0.497,0.542,0.798,1.235,0.798,2.082 c0,2.981-1.814,3.637-3.543,3.829c0.279,0.24,0.527,0.713,0.527,1.437c0,1.037-0.01,1.874-0.01,2.129 c0,0.208,0.14,0.449,0.534,0.373c3.081-1.028,5.302-3.935,5.302-7.362C15.76,3.906,12.285,0.431,7.999,0.431z"/></svg>
</span><span class="username">kenerwin88</span></a>

          </li>
          

          
          <li>
            <a href="https://twitter.com/devopslibrary"><span class="icon icon--twitter"><svg viewBox="0 0 16 16"><path fill="#828282" d="M15.969,3.058c-0.586,0.26-1.217,0.436-1.878,0.515c0.675-0.405,1.194-1.045,1.438-1.809c-0.632,0.375-1.332,0.647-2.076,0.793c-0.596-0.636-1.446-1.033-2.387-1.033c-1.806,0-3.27,1.464-3.27,3.27 c0,0.256,0.029,0.506,0.085,0.745C5.163,5.404,2.753,4.102,1.14,2.124C0.859,2.607,0.698,3.168,0.698,3.767 c0,1.134,0.577,2.135,1.455,2.722C1.616,6.472,1.112,6.325,0.671,6.08c0,0.014,0,0.027,0,0.041c0,1.584,1.127,2.906,2.623,3.206 C3.02,9.402,2.731,9.442,2.433,9.442c-0.211,0-0.416-0.021-0.615-0.059c0.416,1.299,1.624,2.245,3.055,2.271 c-1.119,0.877-2.529,1.4-4.061,1.4c-0.264,0-0.524-0.015-0.78-0.046c1.447,0.928,3.166,1.469,5.013,1.469 c6.015,0,9.304-4.983,9.304-9.304c0-0.142-0.003-0.283-0.009-0.423C14.976,4.29,15.531,3.714,15.969,3.058z"/></svg>
</span><span class="username">devopslibrary</span></a>

          </li>
          
        </ul>
      </div>

      <div class="footer-col footer-col-3">
        <p>Welcome to the DevOps Library!  We have the best videos for the best admins!
</p>
      </div>
    </div>

  </div>

</footer>
<!-- Piwik -->
<script type="text/javascript">
    var _paq = _paq || [];
    _paq.push(['trackPageView']);
    _paq.push(['enableLinkTracking']);
    (function() {
    var u="//kendog15.piwikpro.com/";
    _paq.push(['setTrackerUrl', u+'piwik.php']);
    _paq.push(['setSiteId', 1]);
    var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
    g.type='text/javascript'; g.async=true; g.defer=true; g.src=u+'piwik.js'; s.parentNode.insertBefore(g,s);
    })();
    </script>
<noscript><p><img src="//kendog15.piwikpro.com/piwik.php?idsite=1" style="border:0;" alt="" /></p></noscript>
<!-- End Piwik Code -->


  </body>

</html>
